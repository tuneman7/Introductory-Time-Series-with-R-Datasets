list.of.packages <- c("rstudioapi","tidyverse")

new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(rstudioapi)
library(tidyverse)
get_my_wd <- function()
{
  current_doc <- getActiveDocumentContext()$path 
  current_path <- str_replace(str_replace(paste(gsub("(.*)/.*","\\1",current_doc),"")," ",""), " ","")
  return(current_path)
}

directory <-get_my_wd()

r_file = paste(directory,"/functions.R",sep="")
print(get_my_wd())
print(r_file)

source(r_file)

print(fileandpath("Herald.dat"))

Herald.dat <- read.table(fileandpath("Herald.dat"), header = T)
attach (Herald.dat)

#We now use R to calculate the covariance for the Herald Square pairs in
#three different ways:
x <- Herald.dat$CO; y <- Herald.dat$Benzoa; n <- length(x)
sum((x - mean(x))*(y - mean(y))) / (n - 1)
mean((x - mean(x)) * (y - mean(y)))
cov(x, y)

#The correspondence between the R code above and the expectation defini-
#  tion of covariance should be noted:
#mean((x - mean(x))*(y - mean(y))) → E [(x − μx )(y − μy )]


# In R, the sample correlation for pairs (xi , yi ) stored in vectors x and y is
# cor(x,y). A value of +1 or −1 indicates an exact linear association, with the
# (x, y) pairs falling on a straight line of positive or negative slope, respectively.
# The correlation between the CO and benzoapyrene measurements at Herald
# Square is now calculated both from the definition and using cor.
cov(x,y) / (sd(x)*sd(y))

cor(x,y)


# We will demonstrate the calculations in R using a time series of wave
# heights (mm relative to still water level) measured at the centre of a wave tank.
# The sampling interval is 0.1 second and the record length is 39.7 seconds. The
# waves were generated by a wave maker driven by a pseudo-random signal that
# was programmed to emulate a rough sea. There is no trend and no seasonal
# period, so it is reasonable to suppose the time series is a realisation of a
# stationary process.

wave.dat <- read.table (fileandpath("wave.dat"), header=T) ; 
attach(wave.dat)
plot(ts(waveht)) ; 
plot(ts(waveht[1:60]))
